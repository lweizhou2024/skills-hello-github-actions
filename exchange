function [values, units] = readLargeFileWithScientific(filename)
    % Open the file
    fileID = fopen(filename, 'r');
    
    % Skip header
    fgetl(fileID);
    
    % Read the file as strings
    data = textscan(fileID, '%s', 'Delimiter', '\n');
    fclose(fileID);
    
    % Get the strings
    strings = data{1};
    n = length(strings);
    
    % Prepare output arrays
    values = zeros(n, 1);
    units = cell(n, 1);
    
    % Define the pattern for scientific notation with units
    pattern = '(\d+,\d+(?:E[+-]?\d+)?)([a-zA-Z]*)';
    
    % Process in batches for better performance
    batchSize = 10000;
    numBatches = ceil(n/batchSize);
    
    for b = 1:numBatches
        % Calculate batch indices
        startIdx = (b-1)*batchSize + 1;
        endIdx = min(b*batchSize, n);
        
        % Process batch
        for i = startIdx:endIdx
            % Extract numeric part and unit
            [tokens, ~] = regexp(strings{i}, pattern, 'tokens', 'match');
            
            if ~isempty(tokens)
                % Replace comma with period and convert
                numStr = tokens{1}{1};
                values(i) = str2double(strrep(numStr, ',', '.'));
                units{i} = tokens{1}{2};
            else
                % Handle lines that don't match pattern
                values(i) = NaN;
                units{i} = '';
            end
        end
    end
end
