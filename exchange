function [axisPoint, radius] = fitWithDirection(points, v_guess)
    % 1. Normalize the direction guess
    v = v_guess(:) / norm(v_guess);
    
    % 2. Create a 2D coordinate system on the plane perpendicular to v
    % Find any vector 'nullV' such that nullV is perpendicular to v
    basis = null(v'); 
    e1 = basis(:,1);
    e2 = basis(:,2);
    
    % 3. Project 3D points onto this 2D plane
    % (Subtract mean first to keep numbers small and stable)
    centroid = mean(points);
    shiftedPoints = points - centroid;
    
    xp = shiftedPoints * e1;
    yp = shiftedPoints * e2;
    
    % 4. Fit a circle to (xp, yp) using a linear least squares approach
    % Equation: (x-xc)^2 + (y-yc)^2 = r^2  => x^2 - 2x*xc + xc^2 + y^2 - 2y*yc + yc^2 = r^2
    % Rearranged: 2x*xc + 2y*yc + C = x^2 + y^2  where C = r^2 - xc^2 - yc^2
    A = [2*xp, 2*yp, ones(size(xp))];
    b = xp.^2 + yp.^2;
    params = A\b;
    
    xc = params(1);
    yc = params(2);
    radius = sqrt(params(3) + xc^2 + yc^2);
    
    % 5. Convert 2D center back to 3D
    % The axis point is the centroid + the 2D offsets along the basis vectors
    axisPoint = centroid + xc*e1' + yc*e2';
end
